# WebSocket Server Architecture

Цей документ описує нову архітектуру WebSocket сервера, розділену на менші, більш спеціалізовані класи.

## Структура файлів

```
src/server/
├── WebSocketHandler.php    # Основний клас (спрощений)
├── RoomManager.php         # Управління кімнатами
├── UserManager.php         # Управління користувачами
├── MessageHandler.php      # Обробка повідомлень
└── README.md              # Ця документація
```

## Класи та їх відповідальності

### WebSocketHandler.php
**Відповідальність**: Основний клас, який реалізує MessageComponentInterface
- Делегує всю логіку до внутрішнього ServerWebSocketHandler
- Забезпечує зворотну сумісність з існуючим кодом

### RoomManager.php
**Відповідальність**: Управління кімнатами та переміщення користувачів
- `joinRoom()` - додавання користувача до кімнати
- `leaveRoom()` - видалення користувача з кімнати
- `getClientRoom()` - отримання поточної кімнати користувача
- `getRoomClients()` - отримання списку користувачів кімнати
- `removeClientFromAllRooms()` - видалення користувача з усіх кімнат

### UserManager.php
**Відповідальність**: Управління користувачами та їх іменами
- `setUsername()` - встановлення імені користувача
- `getUsername()` - отримання імені користувача
- `removeUser()` - видалення користувача
- `getAllUsers()` - отримання списку всіх користувачів

### MessageHandler.php
**Відповідальність**: Обробка різних типів повідомлень
- `handleMessage()` - основний метод обробки повідомлень
- `handleChatMessage()` - обробка чат-повідомлень
- `handleJoinRoom()` - обробка приєднання до кімнати
- `handleLeaveRoom()` - обробка виходу з кімнати
- `handlePrivateMessage()` - обробка приватних повідомлень
- `handleSetUsername()` - обробка встановлення імені
- `handleGetUsers()` - обробка запиту списку користувачів

## Переваги нової архітектури

1. **Single Responsibility Principle** - кожен клас має одну чітко визначену відповідальність
2. **Легше тестування** - можна тестувати кожен компонент окремо
3. **Краща читабельність** - код розділений на логічні блоки
4. **Легше розширення** - можна додавати нову функціональність, не змінюючи існуючий код
5. **Менша складність** - кожен файл тепер має менше рядків коду

## Використання

Основний файл `src/WebSocketHandler.php` залишається незмінним для зовнішнього використання, але тепер делегує всю логіку до нових класів у папці `server/`.

## Автор

Розроблено для покращення архітектури WebSocket сервера. 